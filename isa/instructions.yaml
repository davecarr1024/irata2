# IRATA2 Instruction Set Architecture Definition
# Single source of truth for all instruction definitions

# Addressing Modes
addressing_modes:
  - name: Implied
    code: IMP
    operands: 0
    description: "No operands"

  - name: Immediate
    code: IMM
    operands: 1
    description: "Immediate operand"

  - name: Absolute
    code: ABS
    operands: 2
    description: "Absolute 16-bit address"

  - name: ZeroPage
    code: ZP
    operands: 1
    description: "Zero page address (0x00XX)"

  - name: ZeroPageX
    code: ZPX
    operands: 1
    description: "Zero page address indexed by X (wraps within page)"

  - name: ZeroPageY
    code: ZPY
    operands: 1
    description: "Zero page address indexed by Y (wraps within page)"

  - name: Relative
    code: REL
    operands: 1
    description: "Signed byte offset from PC"

# Status Flags
status_flags:
  - name: Zero
    code: Z
    bit: 0
    description: "Set if result is zero"

  - name: Negative
    code: N
    bit: 1
    description: "Set if result bit 7 is set"

  - name: Carry
    code: C
    bit: 2
    description: "Set if carry out or borrow"

  - name: Overflow
    code: V
    bit: 3
    description: "Set if signed overflow"

# Instructions
instructions:
  # System Instructions
  - mnemonic: HLT
    opcode: 0x01
    addressing_mode: IMP
    cycles: 1
    description: "Halt execution"
    category: System
    flags_affected: []

  - mnemonic: NOP
    opcode: 0x02
    addressing_mode: IMP
    cycles: 1
    description: "No operation"
    category: System
    flags_affected: []

  - mnemonic: LDA
    opcode: 0x10
    addressing_mode: IMM
    cycles: 2
    description: "Load accumulator (immediate)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: CMP
    opcode: 0x11
    addressing_mode: IMM
    cycles: 2
    description: "Compare accumulator (immediate)"
    category: Compare
    flags_affected: [Z, N, C]

  - mnemonic: JEQ
    opcode: 0x12
    addressing_mode: ABS
    cycles: 3
    description: "Jump if equal (absolute)"
    category: Branch
    flags_affected: []

  # Arithmetic Instructions
  - mnemonic: ADC
    opcode: 0x20
    addressing_mode: IMM
    cycles: 2
    description: "Add with carry (immediate)"
    category: Arithmetic
    flags_affected: [Z, N, C, V]

  - mnemonic: SBC
    opcode: 0x21
    addressing_mode: IMM
    cycles: 2
    description: "Subtract with carry (immediate)"
    category: Arithmetic
    flags_affected: [Z, N, C, V]

  # Logic Instructions
  - mnemonic: AND
    opcode: 0x22
    addressing_mode: IMM
    cycles: 2
    description: "Logical AND (immediate)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: ORA
    opcode: 0x23
    addressing_mode: IMM
    cycles: 2
    description: "Logical OR (immediate)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: EOR
    opcode: 0x24
    addressing_mode: IMM
    cycles: 2
    description: "Logical XOR (immediate)"
    category: Logic
    flags_affected: [Z, N]

  # Shift Instructions (Accumulator)
  - mnemonic: ASL
    opcode: 0x25
    addressing_mode: IMP
    cycles: 1
    description: "Arithmetic shift left (accumulator)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: LSR
    opcode: 0x26
    addressing_mode: IMP
    cycles: 1
    description: "Logical shift right (accumulator)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: ROL
    opcode: 0x27
    addressing_mode: IMP
    cycles: 1
    description: "Rotate left (accumulator)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: ROR
    opcode: 0x28
    addressing_mode: IMP
    cycles: 1
    description: "Rotate right (accumulator)"
    category: Shift
    flags_affected: [Z, N, C]

  # Register Transfer Instructions
  - mnemonic: TAX
    opcode: 0x30
    addressing_mode: IMP
    cycles: 1
    description: "Transfer A to X"
    category: Transfer
    flags_affected: [Z, N]

  - mnemonic: TXA
    opcode: 0x31
    addressing_mode: IMP
    cycles: 1
    description: "Transfer X to A"
    category: Transfer
    flags_affected: [Z, N]

  - mnemonic: LDX
    opcode: 0x32
    addressing_mode: IMM
    cycles: 2
    description: "Load X register (immediate)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: TAY
    opcode: 0x33
    addressing_mode: IMP
    cycles: 1
    description: "Transfer A to Y"
    category: Transfer
    flags_affected: [Z, N]

  - mnemonic: TYA
    opcode: 0x34
    addressing_mode: IMP
    cycles: 1
    description: "Transfer Y to A"
    category: Transfer
    flags_affected: [Z, N]

  - mnemonic: LDY
    opcode: 0x35
    addressing_mode: IMM
    cycles: 2
    description: "Load Y register (immediate)"
    category: Load
    flags_affected: [Z, N]

  # Zero Page Load/Store Instructions
  - mnemonic: LDA
    opcode: 0x40
    addressing_mode: ZP
    cycles: 3
    description: "Load accumulator (zero page)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: STA
    opcode: 0x41
    addressing_mode: ZP
    cycles: 3
    description: "Store accumulator (zero page)"
    category: Store
    flags_affected: []

  - mnemonic: LDX
    opcode: 0x42
    addressing_mode: ZP
    cycles: 3
    description: "Load X register (zero page)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: STX
    opcode: 0x43
    addressing_mode: ZP
    cycles: 3
    description: "Store X register (zero page)"
    category: Store
    flags_affected: []

  - mnemonic: LDY
    opcode: 0x4E
    addressing_mode: ZP
    cycles: 3
    description: "Load Y register (zero page)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: STY
    opcode: 0x4F
    addressing_mode: ZP
    cycles: 3
    description: "Store Y register (zero page)"
    category: Store
    flags_affected: []

  # Zero Page ALU Instructions
  - mnemonic: ADC
    opcode: 0x44
    addressing_mode: ZP
    cycles: 4
    description: "Add with carry (zero page)"
    category: Arithmetic
    flags_affected: [Z, N, C, V]

  - mnemonic: SBC
    opcode: 0x45
    addressing_mode: ZP
    cycles: 4
    description: "Subtract with carry (zero page)"
    category: Arithmetic
    flags_affected: [Z, N, C, V]

  - mnemonic: AND
    opcode: 0x46
    addressing_mode: ZP
    cycles: 4
    description: "Logical AND (zero page)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: ORA
    opcode: 0x47
    addressing_mode: ZP
    cycles: 4
    description: "Logical OR (zero page)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: EOR
    opcode: 0x48
    addressing_mode: ZP
    cycles: 4
    description: "Logical XOR (zero page)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: CMP
    opcode: 0x49
    addressing_mode: ZP
    cycles: 4
    description: "Compare accumulator (zero page)"
    category: Compare
    flags_affected: [Z, N, C]

  # Zero Page Shift Instructions
  - mnemonic: ASL
    opcode: 0x4A
    addressing_mode: ZP
    cycles: 5
    description: "Arithmetic shift left (zero page)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: LSR
    opcode: 0x4B
    addressing_mode: ZP
    cycles: 5
    description: "Logical shift right (zero page)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: ROL
    opcode: 0x4C
    addressing_mode: ZP
    cycles: 5
    description: "Rotate left (zero page)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: ROR
    opcode: 0x4D
    addressing_mode: ZP
    cycles: 5
    description: "Rotate right (zero page)"
    category: Shift
    flags_affected: [Z, N, C]

  # Absolute Load/Store Instructions
  - mnemonic: LDA
    opcode: 0x50
    addressing_mode: ABS
    cycles: 4
    description: "Load accumulator (absolute)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: STA
    opcode: 0x51
    addressing_mode: ABS
    cycles: 4
    description: "Store accumulator (absolute)"
    category: Store
    flags_affected: []

  - mnemonic: LDX
    opcode: 0x52
    addressing_mode: ABS
    cycles: 4
    description: "Load X register (absolute)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: STX
    opcode: 0x53
    addressing_mode: ABS
    cycles: 4
    description: "Store X register (absolute)"
    category: Store
    flags_affected: []

  - mnemonic: LDY
    opcode: 0x5E
    addressing_mode: ABS
    cycles: 4
    description: "Load Y register (absolute)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: STY
    opcode: 0x5F
    addressing_mode: ABS
    cycles: 4
    description: "Store Y register (absolute)"
    category: Store
    flags_affected: []

  # Absolute ALU Instructions
  - mnemonic: ADC
    opcode: 0x54
    addressing_mode: ABS
    cycles: 5
    description: "Add with carry (absolute)"
    category: Arithmetic
    flags_affected: [Z, N, C, V]

  - mnemonic: SBC
    opcode: 0x55
    addressing_mode: ABS
    cycles: 5
    description: "Subtract with carry (absolute)"
    category: Arithmetic
    flags_affected: [Z, N, C, V]

  - mnemonic: AND
    opcode: 0x56
    addressing_mode: ABS
    cycles: 5
    description: "Logical AND (absolute)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: ORA
    opcode: 0x57
    addressing_mode: ABS
    cycles: 5
    description: "Logical OR (absolute)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: EOR
    opcode: 0x58
    addressing_mode: ABS
    cycles: 5
    description: "Logical XOR (absolute)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: CMP
    opcode: 0x59
    addressing_mode: ABS
    cycles: 5
    description: "Compare accumulator (absolute)"
    category: Compare
    flags_affected: [Z, N, C]

  # Absolute Shift Instructions
  - mnemonic: ASL
    opcode: 0x5A
    addressing_mode: ABS
    cycles: 6
    description: "Arithmetic shift left (absolute)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: LSR
    opcode: 0x5B
    addressing_mode: ABS
    cycles: 6
    description: "Logical shift right (absolute)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: ROL
    opcode: 0x5C
    addressing_mode: ABS
    cycles: 6
    description: "Rotate left (absolute)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: ROR
    opcode: 0x5D
    addressing_mode: ABS
    cycles: 6
    description: "Rotate right (absolute)"
    category: Shift
    flags_affected: [Z, N, C]

  # Register Increment/Decrement Instructions
  - mnemonic: INX
    opcode: 0x60
    addressing_mode: IMP
    cycles: 1
    description: "Increment X register"
    category: Arithmetic
    flags_affected: [Z, N]

  - mnemonic: DEX
    opcode: 0x61
    addressing_mode: IMP
    cycles: 1
    description: "Decrement X register"
    category: Arithmetic
    flags_affected: [Z, N]

  - mnemonic: INY
    opcode: 0x66
    addressing_mode: IMP
    cycles: 1
    description: "Increment Y register"
    category: Arithmetic
    flags_affected: [Z, N]

  - mnemonic: DEY
    opcode: 0x67
    addressing_mode: IMP
    cycles: 1
    description: "Decrement Y register"
    category: Arithmetic
    flags_affected: [Z, N]

  # Memory Increment/Decrement Instructions
  - mnemonic: INC
    opcode: 0x62
    addressing_mode: ZP
    cycles: 5
    description: "Increment memory (zero page)"
    category: Arithmetic
    flags_affected: [Z, N]

  - mnemonic: DEC
    opcode: 0x63
    addressing_mode: ZP
    cycles: 5
    description: "Decrement memory (zero page)"
    category: Arithmetic
    flags_affected: [Z, N]

  - mnemonic: INC
    opcode: 0x64
    addressing_mode: ABS
    cycles: 6
    description: "Increment memory (absolute)"
    category: Arithmetic
    flags_affected: [Z, N]

  - mnemonic: DEC
    opcode: 0x65
    addressing_mode: ABS
    cycles: 6
    description: "Decrement memory (absolute)"
    category: Arithmetic
    flags_affected: [Z, N]

  # Relative Branch Instructions
  - mnemonic: BEQ
    opcode: 0x70
    addressing_mode: REL
    cycles: 2
    description: "Branch if equal (zero set)"
    category: Branch
    flags_affected: []

  - mnemonic: BNE
    opcode: 0x71
    addressing_mode: REL
    cycles: 2
    description: "Branch if not equal (zero clear)"
    category: Branch
    flags_affected: []

  - mnemonic: BCS
    opcode: 0x72
    addressing_mode: REL
    cycles: 2
    description: "Branch if carry set"
    category: Branch
    flags_affected: []

  - mnemonic: BCC
    opcode: 0x73
    addressing_mode: REL
    cycles: 2
    description: "Branch if carry clear"
    category: Branch
    flags_affected: []

  - mnemonic: BMI
    opcode: 0x74
    addressing_mode: REL
    cycles: 2
    description: "Branch if minus (negative set)"
    category: Branch
    flags_affected: []

  - mnemonic: BPL
    opcode: 0x75
    addressing_mode: REL
    cycles: 2
    description: "Branch if plus (negative clear)"
    category: Branch
    flags_affected: []

  - mnemonic: BVS
    opcode: 0x76
    addressing_mode: REL
    cycles: 2
    description: "Branch if overflow set"
    category: Branch
    flags_affected: []

  - mnemonic: BVC
    opcode: 0x77
    addressing_mode: REL
    cycles: 2
    description: "Branch if overflow clear"
    category: Branch
    flags_affected: []

  # Zero Page X-Indexed Instructions
  - mnemonic: LDA
    opcode: 0x80
    addressing_mode: ZPX
    cycles: 4
    description: "Load accumulator (zero page, X-indexed)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: STA
    opcode: 0x81
    addressing_mode: ZPX
    cycles: 4
    description: "Store accumulator (zero page, X-indexed)"
    category: Store
    flags_affected: []

  - mnemonic: LDY
    opcode: 0x82
    addressing_mode: ZPX
    cycles: 4
    description: "Load Y register (zero page, X-indexed)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: STY
    opcode: 0x83
    addressing_mode: ZPX
    cycles: 4
    description: "Store Y register (zero page, X-indexed)"
    category: Store
    flags_affected: []

  - mnemonic: ADC
    opcode: 0x84
    addressing_mode: ZPX
    cycles: 5
    description: "Add with carry (zero page, X-indexed)"
    category: Arithmetic
    flags_affected: [Z, N, C, V]

  - mnemonic: SBC
    opcode: 0x85
    addressing_mode: ZPX
    cycles: 5
    description: "Subtract with carry (zero page, X-indexed)"
    category: Arithmetic
    flags_affected: [Z, N, C, V]

  - mnemonic: AND
    opcode: 0x86
    addressing_mode: ZPX
    cycles: 5
    description: "Logical AND (zero page, X-indexed)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: ORA
    opcode: 0x87
    addressing_mode: ZPX
    cycles: 5
    description: "Logical OR (zero page, X-indexed)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: EOR
    opcode: 0x88
    addressing_mode: ZPX
    cycles: 5
    description: "Logical XOR (zero page, X-indexed)"
    category: Logic
    flags_affected: [Z, N]

  - mnemonic: CMP
    opcode: 0x89
    addressing_mode: ZPX
    cycles: 5
    description: "Compare accumulator (zero page, X-indexed)"
    category: Compare
    flags_affected: [Z, N, C]

  - mnemonic: ASL
    opcode: 0x8A
    addressing_mode: ZPX
    cycles: 6
    description: "Arithmetic shift left (zero page, X-indexed)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: LSR
    opcode: 0x8B
    addressing_mode: ZPX
    cycles: 6
    description: "Logical shift right (zero page, X-indexed)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: ROL
    opcode: 0x8C
    addressing_mode: ZPX
    cycles: 6
    description: "Rotate left (zero page, X-indexed)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: ROR
    opcode: 0x8D
    addressing_mode: ZPX
    cycles: 6
    description: "Rotate right (zero page, X-indexed)"
    category: Shift
    flags_affected: [Z, N, C]

  - mnemonic: INC
    opcode: 0x8E
    addressing_mode: ZPX
    cycles: 6
    description: "Increment memory (zero page, X-indexed)"
    category: Arithmetic
    flags_affected: [Z, N]

  - mnemonic: DEC
    opcode: 0x8F
    addressing_mode: ZPX
    cycles: 6
    description: "Decrement memory (zero page, X-indexed)"
    category: Arithmetic
    flags_affected: [Z, N]

  # Zero Page Y-Indexed Instructions
  - mnemonic: LDX
    opcode: 0x90
    addressing_mode: ZPY
    cycles: 4
    description: "Load X register (zero page, Y-indexed)"
    category: Load
    flags_affected: [Z, N]

  - mnemonic: STX
    opcode: 0x91
    addressing_mode: ZPY
    cycles: 4
    description: "Store X register (zero page, Y-indexed)"
    category: Store
    flags_affected: []

  - mnemonic: CRS
    opcode: 0xFF
    addressing_mode: IMP
    cycles: 1
    description: "Crash (for testing)"
    category: System
    flags_affected: []
